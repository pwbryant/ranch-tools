{% load custom_filters %}
{% load static %}
<link rel="stylesheet" type="text/css" href="{% static 'preg_check/css/styles.css' %}">

<script type="text/javascript">
    <!-- define vars to be used by external js files -->
    const pregcheckSummaryStatsUrl = "{% url 'pregcheck-summary-stats' %}";
    const animalExists = "{{ animal_exists }}";
</script>

<script type="text/javascript" src="{% static 'preg_check/js/script.js' %}"></script>

<div class="container">
    {% include 'preg_check/includes/stats_content.html' %}
    
    <div class="form-container">
        <form id="search-form" method="get" action="">
            {{ search_form.as_p }}
            <button type="submit">Search For Animal</button>
        </form>

        <div class="result-container">
            {% if multiple_matches %}
                <p>More than one animal is associated with this ID with birth years of
                    {% for birth_year in distinct_birth_years %}
                        {{ birth_year }}{% if not forloop.last %}, {% endif %}
                    {% endfor %}.
                    <br>Please provide the birth year to select the desired animal.
                </p>
            {% elif pregchecks %}
                <table>
                    <thead>
                        <tr>
                            <th>Preg Status</th>
                            <th>Check Date</th>
                            <th>Breeding Season</th>
                            {% if pregchecks|has_comments %}
                                <th>Comments</th>
                            {% endif %}
                        </tr>
                    </thead>
                    <tbody>
                        {% for pregcheck in pregchecks %}
                            <tr>
                                {% if pregcheck.is_pregnant %}
                                    <td>Pregnant</td>
                                {% else %}
                                    <td>Open</td>
                                {% endif %}
                                <td>{{ pregcheck.check_date }}</td>
                                <td>{{ pregcheck.breeding_season }}</td>
                                {% if pregcheck.comments %}
                                    <td>{{ pregcheck.comments }}</td>
                                {% endif %}
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                {% if search_form.is_bound %}
                    <p>Animal ID not found</p>
                {% endif %}
            {% endif %}
        </div>
    </div>

    {% include 'preg_check/includes/pregcheck_form.html' %}
    {% include 'preg_check/includes/message_modal.html' %}
    {% include 'preg_check/includes/no_animal_modal.html' %}
</div>

